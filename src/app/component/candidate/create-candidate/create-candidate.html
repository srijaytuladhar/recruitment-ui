<div class="form-container">
  <p-toast position="top-right"></p-toast>

  <div class="header">
    <button pButton label="Back" class="p-button-secondary" (click)="goBack()">
      <i class="pi pi-arrow-left"></i>
    </button>
  </div>

  <h2>Create Candidate Profile</h2>

  <form [formGroup]="candidateForm" (ngSubmit)="saveCandidate()" class="candidate-form">

    <!-- Basic Info -->
    <h3 class="md-1">Basic Information</h3>
    <div class="basic-form">
      <div class="form-row">
        <div class="form-group">
          <label>Name</label>
          <input pInputText type="text" formControlName="name" placeholder="Enter full name"/>
        </div>
        <div class="form-group">
          <label>Email</label>
          <input pInputText type="email" formControlName="emailAddress" placeholder="Enter email"/>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Current Address</label>
          <input pInputText type="text" formControlName="currentAddress" placeholder="Enter current address"/>
        </div>
        <div class="form-group">
          <label>Contact Number</label>
          <input pInputText type="text" formControlName="contactNumber" placeholder="Enter contact number"/>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Preferred Job Location</label>
          <input pInputText type="text" formControlName="jobLocationDesired" placeholder="Enter preferred location"/>
        </div>
        <div class="form-group">
          <label>Job Vertical</label>
          <input pInputText type="text" formControlName="jobVertical" placeholder="Eg: IT, Finance, Marketing"/>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Total Experience (Years)</label>
          <input pInputText type="number" formControlName="totalYearsOfExperience" placeholder="Years of experience"/>
        </div>
        <div class="form-group"></div>
      </div>

    </div>
    <div formArrayName="education">
      <h3 class="md-1">Education</h3>
      <div *ngFor="let edu of education.controls; let i = index" [formGroupName]="i">
        <div class="experience-entry">
          <div class="form-row">
            <div class="form-group">
              <label>College</label>
              <input pInputText type="text" formControlName="college" placeholder="Enter college name"/>
            </div>
            <div class="form-group">
              <label>University</label>
              <input pInputText type="text" formControlName="university" placeholder="Enter university"/>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Degree</label>
              <input pInputText type="text" formControlName="degree" placeholder="Enter degree"/>
            </div>
            <div class="form-group">
              <label>Major</label>
              <input pInputText type="text" formControlName="major" placeholder="Enter major"/>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>GPA / Percentage</label>
              <input pInputText type="text" formControlName="gpa" placeholder="Enter GPA / Percentage"/>
            </div>
            <div class="form-group">
              <label>Completion Date</label>
              <div class="card flex justify-center">
                <p-datepicker
                  formControlName="completionDate"
                  view="month"
                  dateFormat="mm/yy"
                  [readonlyInput]="true"
                  showIcon="true"
                  icon="pi pi-calendar">
                </p-datepicker>
              </div>
            </div>
          </div>
        </div>
        <button pButton type="button" label="Remove" icon="pi pi-minus" iconPos="left" class="p-button-danger"
                (click)="removeEducation(i)"></button>
        <hr *ngIf="i !== education.controls.length - 1"/>
      </div>

      <button pButton type="button" label="Add Education" icon="pi pi-plus" iconPos="left" class="p-button-primary mt-2"
              (click)="addEducation()"></button>
    </div>

    <div formArrayName="experience">
      <h3 class="md-1">Experience</h3>
      <div *ngFor="let exp of experience.controls; let i = index" [formGroupName]="i">
        <div class="experience-entry">
          <div class="form-row">
            <div class="form-group">
              <label>Company Name</label>
              <input pInputText type="text" formControlName="companyName" placeholder="Enter company name"/>
            </div>
            <div class="form-group">
              <label>Location</label>
              <input pInputText type="text" formControlName="location" placeholder="Enter location"/>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Role</label>
              <input pInputText type="text" formControlName="role" placeholder="Enter role"/>
            </div>
            <div class="form-group">
              <label>Description</label>
              <input pInputText type="text" formControlName="description" placeholder="Enter role description"/>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Start Date</label>
              <div class="card flex justify-center">
                <p-datepicker
                  formControlName="startDate"
                  view="month"
                  dateFormat="mm/yy"
                  [readonlyInput]="true"
                  showIcon="true"
                  icon="pi pi-calendar">
                </p-datepicker>
              </div>
            </div>

            <div class="form-group">
              <label>End Date</label>
              <div class="card flex justify-center">
                <p-datepicker
                  formControlName="endDate"
                  view="month"
                  dateFormat="mm/yy"
                  [readonlyInput]="true"
                  showIcon="true"
                  icon="pi pi-calendar"
                  [disabled]="experience.controls[i].get('current')?.value">
                </p-datepicker>
              </div>
            </div>

            <div class="form-group">
              <label>Current</label>
              <p-checkbox formControlName="current" binary="true"></p-checkbox>
            </div>
          </div>
        </div>
        <button
          pButton
          type="button"
          label="Remove"
          icon="pi pi-minus"
          iconPos="left"
          class="p-button-danger"
          (click)="removeExperience(i)">
        </button>

        <hr *ngIf="i !== experience.controls.length - 1"/>
      </div>

      <button
        pButton
        type="button"
        label="Add Experience"
        icon="pi pi-plus"
        iconPos="left"
        class="p-button-primary mt-2"
        (click)="addExperience()">
      </button>
    </div>

    <div class="form-group">
      <label>Resume Upload</label>
      <p-fileUpload
        mode="basic"
        chooseLabel="Choose"
        chooseIcon="pi pi-upload"
        name="resume"
        accept="application/pdf, image/*"
        maxFileSize="10000000"
        (onSelect)="onUpload($event)">
      </p-fileUpload>
    </div>

    <div class="form-actions mt-3">
      <button pButton type="submit" label="Save Candidate" class="p-button-success"></button>
    </div>

  </form>
</div>
